(function(e,t,n){"use strict";function i(e){function i(i,r,s){function o(){for(var e=0,t=w.length;t>e;e++){var n=w[e];n.parent.unbind(n)}w=[]}function a(e){var t=!1;"!"===e.slice(0,1)&&(t=!0,e=e.slice(1));for(var r,s,o,a=e.split("."),l=0,u=a.length;u>l;l++){o=s||i,r=a[l];var h=r.indexOf("[");if(h>-1&&r.indexOf("]")===r.length-1){var c=r.slice(h+1,-1);o=o[r.slice(0,h)],r=c}if(s=o[r],s===n||null===s)break}return t&&(s=!s),{propertyName:r,value:s,parent:o}}function l(e){var t=e.getAttribute("data-tie");if(t){for(var i=t.split(","),r={},s=0,o=i.length;o>s;s++){var a=i[s].split(":");r[a[0].trim()]=a[1].trim()}return r}return n}function u(e,t){e.checked=!!a(t).value}function h(e,t){var n="data-tie-class",i=e.getAttribute(n);i||(i=e.getAttribute("class"),e.setAttribute(n,i));var r=i+" "+a(t).value;e.setAttribute("class",r)}function c(e,t){e.disabled=!!a(t).value}function p(e,t,n){for(var i=a(t).value||n,r=e.querySelectorAll("input[type=radio]"),s=0;r.length>s;s++){var o=r[s];o.checked=o.getAttribute("value")===i}}function f(e,t,n){var i=a(t).value;e.textContent=i||n}function d(e,t,n){var i=a(t).value;e.value=i||n}function v(e,t){var n=!!a(t).value;e.style.display=n?"":"none"}function y(e){switch(e){case"checked":return u;case"class":return h;case"disabled":return c;case"radio":return p;case"text":return f;case"value":return d;case"visible":return v}}function g(t,n,i,r){var s=y(t);if(s){var o=function(){s(r,n,i)};w.push(o);var l=a(n);if(o.parent=l.parent,l.parent instanceof e.Model?l.parent.bind("change:"+l.propertyName,o):l.parent.bind("change",o),"checked"===t||"value"===t)r.addEventListener(O,function(){var e=a(n);e.parent[e.propertyName]="checked"===t?!!r.checked:r.value});else if("radio"===t)for(var u=r.querySelectorAll("input[type=radio]"),h=function(e){var t=a(n);t.parent[t.propertyName]=e.target.getAttribute("value")},c=0;u.length>c;c++)u[c].addEventListener(O,h);s(r,n,i)}}function b(e,n){e.addEventListener(L,function(){function i(){o.removeEventListener(O,i),o.removeEventListener("keypress",r),o.removeEventListener("blur",i);var t=a(n);t.parent[t.propertyName]=o.value,s.insertBefore(e,o.nextSibling),s.removeChild(o)}function r(e){13===e.keyCode&&(i(),e.preventDefault())}var s=e.parentNode,o=t.createElement("input");o.setAttribute("type","text"),o.setAttribute("value",e.textContent),o.setAttribute("class",e.getAttribute("class")),o.addEventListener(O,i),A&&o.addEventListener("keypress",r),E&&o.addEventListener("blur",i),s.insertBefore(o,e.nextSibling),s.removeChild(e),o.focus()})}function _(e){if(e.nodeType===Node.ELEMENT_NODE){var t=l(e);if(t){var i=t["default"];(i===n||null===i)&&(i="number"===e.getAttribute("type")?0:"");for(var r in t)if(t.hasOwnProperty(r)){var s=t[r];g(r,s,i,e),"text"===r&&"true"===t.editable&&b(e,s)}}for(var o=0,a=e.childNodes.length;a>o;o++)_(e.childNodes[o])}}function m(e){var n=t.createDocumentFragment(),i=t.createElement(e.match(/^<tr[\s>]/)?"tbody":"div");for(i.innerHTML=e;i.firstChild;){var r=i.firstChild;_(r),n.appendChild(r)}return n}s=s||{};var L=s.editEvent||"dblclick",O=s.saveEvent||"change",A=s.saveOnEnter!==!1,E=s.saveOnBlur!==!1,w=[];r.render?this.render=function(){return o(),m(r.render(i))}:"function"==typeof r?this.render=function(){return o(),m(r(i))}:"string"==typeof r?this.render=function(){return o(),m(r)}:i.log("Unknown template type: "+r)}e.Tie=i}if("function"==typeof define&&define.amd)define(function(e){var t=e("laces");return i(t),t});else{var r={Model:e.LacesModel,Map:e.LacesMap,Array:e.LacesArray};i(r),e.LacesTie=r.Tie}})(this,document);